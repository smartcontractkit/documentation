---
export const prerender = false

import Chain from "~/components/CCIP/Chain/Chain.astro"
import DecommissionedChain from "~/components/CCIP/Chain/DecommissionedChain.astro"
import {
  Environment,
  getAllNetworks,
  Network,
  getAllDecommissionedNetworks,
  DecommissionedNetwork,
  getNetwork,
  getDecommissionedNetwork,
} from "~/config/data/ccip"

// Handle dynamic routing
const { chain } = Astro.params
const environment = Environment.Mainnet

// Get data dynamically
const activeNetworks = getAllNetworks({ filter: environment })
const decommissionedNetworks = getAllDecommissionedNetworks({ filter: environment })

const activeNetwork = activeNetworks.find((n) => n.chain === chain)
const decomNetwork = decommissionedNetworks.find((n) => n.chain === chain)
const isDecommissioned = !activeNetwork && !!decomNetwork

// Handle 404s
if (!activeNetwork && !decomNetwork) {
  return Astro.redirect("/404")
}
---

{
  isDecommissioned ? (
    <DecommissionedChain network={decomNetwork!} environment={environment} />
  ) : (
    <Chain network={activeNetwork!} environment={environment} />
  )
}
