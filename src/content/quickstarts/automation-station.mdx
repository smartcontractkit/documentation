---
title: "Automation Station"
description: "Use FlashLiquidity's Automation Station to manage your upkeeps."
image: "QuickStarts-Batch-Collection-Reveal.webp"
products: ["automation"]
time: "180 minutes"
requires: "Wallet with gas token & ERC-677 LINK"
---

import { Accordion, Aside, CodeSample, ClickToZoom } from "@components"

## Overview

This tutorial shows how to create, manage, fund and batch migrate [Chainlink Automation](https://automation.chain.link) upkeeps using [FlashLiquidity](https://www.flashliquidity.finance/)'s [Automation Station](https://github.com/flashliquidity/flashliquidity-automation/tree/main).


{/* prettier-ignore */}
<div class="remix-callout">
  <a href="https://github.com/flashliquidity/flashliquidity-automation/tree/main">See the code on GitHub</a>
</div>

## Objective

In this tutorial, you will deploy the [AutomationStation contract](https://github.com/flashliquidity/flashliquidity-automation/blob/main/contracts/AutomationStation.sol) and use it to manage your upkeeps.

<Aside type="caution" title="Disclaimer">
  This tutorial represents an example of using a Chainlink product or service and is provided to help you understand how
  to interact with Chainlink's systems and services so that you can integrate them into your own. This template is
  provided "AS IS" and "AS AVAILABLE" without warranties of any kind, has not been audited, and may be missing key
  checks or error handling to make the usage of the product more clear. Do not use the code in this example in a
  production environment without completing your own audits and application of best practices. Neither Chainlink Labs,
  the Chainlink Foundation, nor Chainlink node operators are responsible for unintended outputs that are generated due
  to errors in code.
</Aside>

## Before you begin

Before you start this tutorial, complete the following items:

- If you are new to smart contract development, learn how to [Deploy Your First Smart Contract](/getting-started/deploy-your-first-contract).
- Set up a cryptocurrency wallet such as [MetaMask](https://metamask.io/).
- To deploy this contract on testnets, ensure the deployer account has testnet ERC-677 LINK. Use the [LINK faucet](https://faucets.chain.link/) to retrieve testnet LINK.
- Install [Nodejs](https://nodejs.org/en/)
- Install [yarn](https://yarnpkg.com/getting-started/install)

## Steps to implement

<Accordion title="Install the dependencies" number={1}>

Clone the source and install the required packages:

1. Install [foundry](https://book.getfoundry.sh/getting-started/installation), or update it to the latest version by running `foundryup -v`.

1. Clone the `flashliquidity-automation` repo:

    ```sh
    git clone https://github.com/flashliquidity/flashliquidity-automation.git && \
    cd flashliquidity-automation
    ```

1. Install the other package dependencies:

    ```sh
    yarn setup
    ```

1. Copy the `.env.example` file to `.env` at the root of the directory:

    ```sh
    cp .env.example .env
    ```

1. In the .env file, set your private key and the RPC URL for the network you're using.

</Accordion>

<Accordion title="Deploy the AutomationStation contract" number={2}>

Deploy the AutomationStation contract to an Automation supported network by setting parameters
within a deployment script, and then running the deployment script.

1. Navigate to the `scripts/deployStation.ts` file to find the deployment script.
1. Edit the deployment script, filling in the required parameters for the `AutomationStation` constructor. Make sure to format each value as a string:
    - `linkToken`: The address of the ERC-677 compatible LINK token. For this example, you can use the address for Arbitrum Sepolia (`'0xb1D4538B4571d411F07960EF2838Ce337FE1E80E'`) or see [all the LINK token addresses for other networks](/resources/link-token-contracts). (If you're using bridged LINK for certain networks, the LINK may not be ERC-677 compatible. Use the [Chainlink Pegswap service](https://pegswap.chain.link/) to convert Chainlink tokens to be ERC-677 compatible before funding the station).
    - `registrar`: The address of the Chainlink Automation registrar for the [selected network](/chainlink-automation/overview/supported-networks). (For Arbitrum Sepolia, the registrar address is `'0x881918E24290084409DaA91979A30e6f0dB52eBe'`.)
    - `registerUpkeepSelector`: The Chainlink Automation Registrar 4-byte [function selector](/resources/glossary#function-selector) of `registerUpkeep`. (Default value: `'0x3f678e11'`)
    - `refuelAmount`: The amount of LINK tokens that the AutomationStation adds to an underfunded upkeep's balance. (Default value: `'1000000000000000000'` or 1 LINK)
    - `stationUpkeepMinBalance`: The minimum balance of LINK tokens for the main station upkeep. If the balance falls below this threshold, the main station upkeep is considered underfunded. (Default value: `'1000000000000000000'` or 1 LINK)
    - `minDelayNextRefuel`: The minimum delay time in seconds between consecutive refuels of the same upkeep (main station upkeep excluded). (Default value: `'600'` or 10 minutes)
    - `approveAmountLINK`: The initial allowance of LINK tokens to the Chainlink Automation Registrar. (Default value: `'100000000000000000000'` or 100 LINK)
1. Save your changes to the `scripts/deployStation.ts` file.
1. Run the deployment script:

    ```sh
    npx hardhat run scripts/deployStation.ts --network arbitrum_sepolia
    ```

You can view the supported networks for the deployment scripts inside the Hardhat configuration file (`hardhat.config.ts`) and add any required network if it is missing.

After you've run the deployment script successfully, the output shows the address of your AutomationStation contract:

```sh
Compiled 15 Solidity files successfully (evm target: paris).
AutomationStation deployed to: 0x794Db242b1d75663E2d821B0105cFd4E5Bb182F0
```
</Accordion>

<Accordion title="Fund and initialize the AutomationStation" number={3}>

After deploying the `AutomationStation` contract, you need to fund the station contract before initializing it as an upkeep. During the initialization process, the main station upkeep will be registered. This upkeep will automate monitoring all the other registered upkeeps to ensure they are not underfunded; if they are, it will add funds to their balance.

Before running the initialization script `scripts/initializeStation.ts`, you need to edit the following arguments:

1. Navigate to the `scripts/initializeStation.ts` file to find the initialization script.
1. Edit the initialization script, filling in the following required parameters to register your deployed AutomationStation contract as an upkeep on Chainlink Automation:
    - `registry`: The address of the Chainlink Automation Registry for the [selected network](/chainlink-automation/overview/supported-networks). This parameter is optional; if you set it now, the Automation forwarder of the station will be automatically set during initialization. Otherwise, you must set the forwarder before registering other upkeeps.
    - `registrationParams`: The encoded registration parameters for the main station upkeep (the `adminAddress` and `upkeepContract` need to be the station address; an example of how to encode the [registration parameters](/chainlink-automation/guides/register-upkeep-in-contract#register-the-upkeep) is provided inside the script.
1. Save your changes to the `scripts/initializeStation.ts` file.
1. Run the initialization script:

    ```sh
    npx hardhat run scripts/initializeStation.ts --network arbitrum_sepolia
    ```

</Accordion>

<Accordion title="Register new upkeeps" number={4}>

Once initialized, the station's `registerUpkeep` function can be used to register a new Chainlink Automation upkeep. The station monitors the newly registered upkeep to ensure that the upkeep meets the minimum LINK token balance required for execution. If the balance falls below this threshold, the station uses its own LINK token balance to increase the upkeep balance until it meets the required minimum.

To register a new upkeep, you will need to edit the necessary parameters inside `scripts/registerUpkeep.ts` and run the script. Once again, in the encoded `registrationParams`, the `adminAddress` must be the address of the station itself. The station must also hold an amount of LINK tokens greater than or equal to the `amount` parameter encoded in the `registrationParams`, and the allowance of LINK tokens to the Chainlink Automation Registrar must also be greater than or equal to this amount.

```
npx hardhat run scripts/registerUpkeep.ts --network arbitrum_sepolia
```
</Accordion>

<Accordion title="Add upkeeps to monitor" number={5}>

1. Use the `addUpkeeps` function to add a list of existing upkeeps for your Automation Station to monitor.

</Accordion>

<Accordion title="Use batch functions" number={6}>

You can run the following functions to modify a batch of existing upkeeps:

- `pauseUpkeeps`
- `unpauseUpkeeps`
- `withdrawUpkeeps`
- `migrateUpkeeps`

</Accordion>

<Accordion title="Dismantle the Automation Station" number={7}>

1. Remove all the upkeeps that the Automation Station upkeep is monitoring, by using the `removeUpkeep` function. This function removes one upkeep at a time from the station's watchlist.

1. When all upkeeps are removed from the station's watchlist, you can call the `dismantle` function.

</Accordion>
